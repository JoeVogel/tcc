%twoside frente e verso do contrário oneside
\documentclass[msc, oneside]{ppgiathesis}
\usepackage{listings}
\usepackage{color}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{epsfig}
\usepackage{epstopdf}
\usepackage{bigstrut}
\usepackage{float}
%Referências no Formato ABNT:
\usepackage[alf]{abntex2cite}
\usepackage[latin1]{inputenc}
\usepackage[Algoritmo]{algorithm}
\usepackage{algorithmic}

\graphicspath{ {images/} }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Hifenizacao

\hyphenation{co-nhe-ci-men-to tra-ba-lhan-do com-pos-to
a-pli-ca-do}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Nome do Aluno
\author{JOE JONAS VOGEL}

% Titulo da dissertação
\title{DISPOSITIVO PARA TELEMETRIA DOS DADOS DE OPERAÇÂO DE TRATORES AGRÍCOLAS}

% Orientador
\adviser{Manfred Heil Júnior}

% Co-Orientador (Retirar se não existir)
\coadviser{Luciano de Souza Ribeiro Bueno}

% Cidade
\address{Jaraguá do Sul}

% Data
\date{2015}

% Área de Concentração
\majorfield{Ciência da Computação}

\begin{document}

% Folha de Rosto
\frontpage


% Informações
\informations{VOGEL}{Joe Jonas}{Telemetria}{Agricultura de Precisão}{Arduino}

% Dedicatória
\begin{dedicatory}
    Aqui vai a dedicatória
\end{dedicatory}


% Agradecimentos
\acknowledgements

	Aqui vai os agradecimentos

% Sumário (não alterar)
\tableofcontents

% Lista de Figuras (Retirar se não existir)
\listoffigures

% Lista de Tabelas (Retirar se não existir)
\listoftables

% Lista de Símbolos (Retirar se não existir)
\listofsymbols

% Lista de Abreviações (Retirar se não existir)
\listofabreviations

% Resumo
\resumo

% \noindent para não criar parágrafo (Retirar se existir parágrafo)
\noindent %Resumo (Não esquecer de especificar o tipo do trator)
\begin{keywords}
    Telemetria, Agricultura de Precisão, Arduino.
\end{keywords}

% Abstract
\abstract

% \noindent para não criar parágrafo (Retirar se existir parágrafo)
\noindent %Abstract

\begin{keywords}
    Telemetry, Precision Agriculture, Arduino.
\end{keywords}

% Não remover
\mainmatter

% Muda a posição e o algorísmo das páginas e reinicia o contador
\changepage

\chapter{Introdução}\label{cap_intro}

A \abrevpuc{AP}{Agricultura de Precisão} vem avançando muito nos últimos anos. Esta é uma área que tem se consolidado fortemente. Com todas as transformações que a AP vem sofrendo, ela tem se tornado muito competitiva e exige maiores níveis de especialização, capacidade de gerenciamento e profissionalismo. Baseados nisso, os agricultores, além de administradores, cada vez mais necessitam assumir a função de pesquisadores em suas áreas, coletando informações, interagindo com novas técnicas e tomando decisões eficazes de manejo. A viabilidade da atividade e a lucratividade dependem de fatores controláveis e incontroláveis que definem a produção agrícola. Devido a isso, a aplicação dos recursos de forma eficiente é indispensável como garantia de sucesso. Isso demanda muito conhecimento e pesquisa sobre os fatores que interagem na lavoura e sobre como eles podem ser maximizados \cite{Pires2004}.

A AP é um sistema de gerenciamento. Seu crescimento se deve principalmente aos avanços tecnológicos envolvendo: sistema de posicionamento global (GPS), sensoreamento remoto, aplicação de insumos em taxas variáveis, sistema de informação geográfica (GIS), entre outros \cite{Pires2004}.

Com todo este avanço da AP, o Brasil ainda não está no mesmo ritmo de países onde o investimento na pesquisa e desenvolvimento é levado mais a sério. Para se ter uma ideia, o Brasil é conhecido mundialmente pela sua vocação natural para a agricultura. Esta vocação se deve a vasta área territorial combinada com a oferta de sol e água, que são recursos fundamentais para as atividades agrícolas. Ainda assim, o Brasil é o quinto maior produtor agrícola do mundo, com produção somando cerca de US{\$} 100 bilhões, segundo dados do Instituto de Estudos do Comércio e Negociações Internacionais (Ícone). Ficando atrás da China, União Europeia, Estados Unidos e Índia. Em sexto colocado vem o Japão \cite{TENORIO2011}.

Mesmo com todo o território e condição climática que o Brasil possui, o seu resultado é  muito próximo de países como Japão e Índia que possuem condições geográficas mais hostis para a agricultura.

Um dos grandes problemas que o Brasil enfrenta é a falta de tecnologias de ponta, utilizadas por outros países. Um exemplo são os tratores agrícolas utilizados no Brasil, estes não conseguem entregar os resultados esperados para eles. O motivo disso, é que as fabricantes de tratores são de fora do Brasil, e essas empresas testam seus equipamentos nas condições de trabalho de seus países. No Brasil apenas temos montadoras dessas fabricantes, os tratores são montados de acordo com o que foi especificado. 

Uma das principais funções dos tratores agrícolas é transformar a energia contida no combustível e fornecê-la, através da barra de tração, para tracionar maquinas e implementos agrícolas. O desempenho na barra de tração depende de diversos fatores como potencia do motor, transmissão, entre outros. Entre os fatores que interferem na tração, a condição do solo é muito importante \cite{filho2010desempenho}.

Porém, na hora de usar este trator, ele acaba não conseguindo exercer a atividade como deveria, isso é devido a fatores como: as condições climáticas, de solo, de combustível, entre outras que ele enfrenta no Brasil não são como as testadas pelo fabricante. Isso implica consideravelmente no desempenho do aparelho.

Neste cenário, alguns testes manuais são aplicados nos tratores, porém, estes não são o suficiente para que se possa avaliar a verdadeira causa das perdas, por exemplo, fica limitada a obtenção de alguns dados, como temperatura do combustível, fluxo de combustível, vazão de ar, força executada pelo trator, entre outros.

O desenvolvimento de novas tecnologias para apoiar a agricultura faz-se cada vez mais necessário devido a diversos fatores. Se pararmos para analisar a atual situação mundial, muito se fala em sustentabilidade. De acordo com o \cite{SESC2015} "O conceito de sustentabilidade tem sua origem relacionada ao termo "desenvolvimento sustentável", definido como aquele que atenda às necessidades das gerações presentes sem comprometer a capacidade das gerações futuras de suprirem suas próprias necessidades."

\section{Problema}

Vários estudos já foram feitos sobre o desempenho de tratores agrícolas nas mais variadas condições para analisar por exemplo a perda de potência devido aos tipos de solo, pneu utilizado, lastragem e da velocidade de deslocamento. Os dados para essas análises são obtidos por meio de instrumentação e monitoramento dos tratores, permitindo a detecção de fatores diretamente envolvidos com a eficiência de trabalho do trator\cite{filho2010desempenho}.

Porém, estes dados ainda são obtidos de formas manuais e exaustivas, tendo seus testes feitos de forma manual e assim gerando dados propensos a erros. Isso gera a necessidade de melhorar este processo adicionando mais veracidade e também facilidade a tomada de dados. 

%O desafio é desenvolver um dispositivo para captação de dados relevantes ao funcionamento do trator em tempo real por meio de diversos sensores utilizando a plataforma Arduino para o processamento dos dados coletados e ZigBee para envio dos dados coletados para a análise.

Como podemos melhorar este cenário de modo que os dados relevantes ao funcionamento do trator possam ser coletados de forma eficiente e sem intervenção humana, e que além disso ainda sejam mais precisos se comparados a realidade atual?

\section{Justificativa}

O desenvolvimento de novas tecnologias para apoiar a agricultura faz-se cada vez mais necessário devido a diversos fatores. Se pararmos para analisar a atual situação mundial, muito se fala em sustentabilidade. Dessa forma cresce cada vez mais a demanda por máquinas agrícolas que possam desempenhar suas atividades de forma rápida e da maneira mais eficiente. 

Uma forma de auxiliar nisso, é análisar o desempenho dessas máquinas e avaliar os pontos onde podemos otimizar a eficiência delas.

Este projeto visa contribuir diretamente nas atividades de telemetria de tratores agrícolas. Com os dados obtidos nas análises, pode-se evoluir o desempenho dos mesmos nas condições de trabalho aos quais são submetidos. Isso impacta em menos consumo de combustível, menos emissão de poluentes, menos desgaste de peças, entre outros.

\section{Objetivos}

Este trabalho é voltado a telemetria da operação de tratores agrícolas. O objetivo é fazer com que os dados da operação sejam colhidos e enviados para a análise por meio de um dispositivo ligado ao trator em teste. E além disso, o dispositivo deve ser de fácil adaptação a vários tipos de tratores agrícolas.

\subsection{Objetivo Geral}

Desenvolver dispositivo (\textit{End Device}) capaz de coletar dados relevantes do funcionamento do trator em tempo real utilizando uma placa controladora e vários sensores comerciais para o processamento dos dados coletados e \abrevpuc {RF} {Rádio Frequência} para envio dos dados coletados para a análise.

\subsection{Objetivos Específicos}

\begin{itemize}

\item Estudar e entender os conceitos de Interrupções no Arduíno;

\item Estudar e entender melhor o funcionamento do protocolo ZigBee;

\item Compreender o conhecimento necessário sobre os sensores que serão instalados nos sensores a fim de melhor gerenciar eles com o dispositivo a ser desenvolvido;

\item Conhecer e entender as informações básicas sobre o funcionamento do trator a fim de visualizar as situações a qual o dispositivo será submetido;

\item Identificar as boas práticas para engenharia de sistemas;

\item Desenvolver o dispositivo, software e documentação aplicando boas práticas de engenharia de sistemas;

\item Analisar os resultados alcançados, a fim de ressaltar a relevância do resultado esperado.

\end{itemize}

\section{Organização do Trabalho}

Este trabalho está organizado em capítulos. O primeiro é a Fundamentação que tem como objetivo deixar o leitor mais familiarizado com a agricultura de precisão, tratores agrícolas, tipos de sensores que serão utilizados, plataforma Arduino e padrões de comunicação RF, entre outras informações pertinentes. Estas serão divididas em seções a fim de facilitar a leitura e o entendimento. 

Após a Fundamentação, virá a seção Desenvolvimento onde será exposto o assunto de modo substantivo, lógico e detalhado. Este irá conter as informações referentes ao processo de desenvolvimento do objetivo do trabalho, contemplando informações como: desenvolvimento do harware e do software, dificuldades, testes, entre outros. Também será organizado por meio de seções para a melhor disposição da matéria.

Na sequencia vem o capítulo Resultados onde serão apresentados os resultados obtidos de forma objetiva, exata, clara e lógica. Neste capítulo o leitor poderá encontrar as relações entre causa e efeito.

E ao final, o trabalho trará a Conclusão. Este capítulo irá apontar tudo que foi descoberto, diante de profunda pesquisa e investigação ao longo do desenvolvimento do trabalho.

\chapter{Fundamentação}\label{cap_fundamentacao}

No decorrer deste capítulo, será realizada a coleta das informações pertinentes à fundamentação do conhecimento necessário para o desenvolvimento do objetivo do trabalho, além de familiarizar o leitor que desejar se aprofundar mais na área desse trabalho.

\section{Agricultura de Precisão}

Normalmente a AP é associada ao uso de equipamentos de alta tecnologia para avaliar, ou monitorizar, as condições numa determinada parcela de terreno. Com essa avaliação é feita a aplicação de sementes, fertilizantes, fitofármacos, reguladores de crescimento, água, etc. de forma otimizada\cite{coelho2004agricultura}.

Tanto a monitoria quanto a aplicação diferenciada exigem a utilização de tecnologias recentes,
como os sistemas de posicionamento global (GPS - Global Positioning System), os
sistemas de informação geográfica (SIG) e os sensores eletrônicos \cite{coelho2004agricultura}. Na Figura ~\ref{fig_gpsNaAP} temos uma ilustração do GPS na AP e na Figura ~\ref{fig_sig} temos os componentes de um SIG.

\begin{figure}[h!]
  \centering
  \epsfig{file=GPS.eps}
  \caption{GPS na Agricultura de Precisão}
  \label{fig_gpsNaAP}
\end{figure}

\begin{figure}[h!]
  \centering
  \epsfig{file=solucoes_sig.eps}
  \caption{Componentes de um SIG (Sistema de Informação Geográfica)}
  \label{fig_sig}
\end{figure}

Com a concepção do GPS (Global Position System) em 1995, viabilizou-se a instalação de receptores em colhedoras, possibilitando armazenar dados de produção instantânea associada à coordenada geográfica. Em 1996, surge no mercado, colhedoras com capacidade de mapeamento da produção, gerando o boom da Agricultura de Precisão no mundo, tornando possível a prática de mapeamento e aplicação de insumos à taxa variada por meio de máquinas \cite{inamasu2014agricultura}.

A AP pode ser entendida então como uma forma de gestão da lavoura que leva em conta a variabilidade espacial. Pois, em tese, a variação pode ser suficientemente reduzida para que a lavoura seja considerada próxima do uniforme. O retorno econômico, portanto, depende de cada lavoura e dos processos de cada produtor \cite{inamasu2014agricultura}.

\section{Avaliação de Desempenho de Tratores Agrícolas}

Uma das principais funções dos tratores agrícolas é transformar a energia contida no combustível e fornecê-la, através da barra de tração, para tracionar maquinas e implementos agrícolas. O desempenho na barra de tração depende de diversos fatores como potencia do motor, transmissão, entre outros. Entre os fatores que interferem na tração, a condição do solo é muito importante \cite{filho2010desempenho}.

Vários estudos já foram feitos por outros autores nessa área para analisar a perda de potência de tratores devido aos tipos de solo, pneu utilizado, lastragem e da velocidade de deslocamento. Os dados para essas análises são obtidos por meio de instrumentação e monitoramento dos tratores, permitindo a detecção de fatores diretamente envolvidos com a eficiência de trabalho do trator\cite{filho2010desempenho}.

Outro exemplo de análise de desempenho de tratores é o artigo de \cite{serrano2007desempenho} que faz a análise de parâmetros como: o regime do motor, a velocidade teórica e a velocidade real de avanço, o consumo horário de combustível e a força de tração na barra de tração. Também foram realizados testes dos tratores com um freio dinamométrico ligado à \abrevpuc{TDP}{Tomada de Potência}. Os resultados validam a relação linear entre a força de tração por unidade de largura de trabalho do implemento e o consumo de combustível por hectare, indicador do dimensionamento do conjunto trator-implemento. Os dados obtidos também evidenciam as vantagens de se selecionarem marchas altas e baixa rotação do motor. 

No caso acima, o autor utilizou parte da infraestrutura do sistema de informação do próprio trator que apenas exibe os dados e para superar o fato de a informação não ficar registrada, foi desenvolvido um \abrevpuc{SAD}{Sistema de Aquisição de Dados}. A instalação de uma tomada em T, na ligação entre o computador e o painel do sistema de informação, permitiu derivar os sinais dos sensores referidos para um circuito eletrônico constituído por: uma caixa de terminais (com oito canais) e de condicionamento de sinal, para converter sinais analógicos registrados pelos sensores em sinais digitais; uma placa de aquisição de dados, como interface para um computador portátil, sistema de armazenamento e tratamento de dados. Além dos sensores referidos, foi instalada uma célula de carga, interposta na ligação trator-implemento \cite{serrano2007desempenho}.

\section{Arduino}

O Arduino é uma plataforma eletrônica de código aberto baseado em hardware e software de fácil utilização \cite{ARDUINO2015}.

Sua programação é feita em sua maioria nas linguagens C e C++, porém não se limita a elas. Como o Arduino é de código aberto, podemos encontrar vários experimentos utilizando outras linguagens de programação como: Java, JavaScript, Go, entre outras.

O Arduino detecta o ambiente por meio de entradas provenientes dos mais variados tipos de sensores, e atua sobre o ambiente por meio de atuadores como: leds, motores, entre outros. Atualmente existem várias placas Arduino, elas variam em tamanho, memória, clock, portas, etc. Desta forma elas podem atender as mais variadas necessidades \cite{ARDUINO2015}.

A plataforma Arduino facilita muito a vida de intusiastas que não contemplam conhecimentos mais avançados na área de microcontroladores, pois ele já vem com o hardware preparado para o uso. A plataforma Arduino associa, principalmente, a facilidade de programação com a disponibilidade de inúmeros periféricos na forma de módulos.

Por meio de ligações simples, facilmente podemos conectá-lo a sensores, motores, leds, entre outros, isso faz com que ele seja muito conhecido e utilizado em pequenos e grandes projetos de automação e Internet das Coisas por exemplo. Devido a isso, este foi o microcontrolador escolhido para este projeto.

Uma das placas Arduino mais utilizadas em projetos maiores é o Arduino Mega 2560. Devido a quantidades de portas disponiveis para utilização e processamento necessário aliado ao custo. A Figura ~\ref{fig_megaFrente} mostra como é a placa Arduino Mega.

\begin{figure}[h!]
  \centering
  \epsfig{file=ArduinoMega2560_R3_Front_450px.eps}
  \caption{Arduino Mega 2560 R3}
  \label{fig_megaFrente}
\end{figure}

O Arduino Mega 2560 é uma placa controladora baseada no microcontrolador ATMega2560 da Atmel Corporation. Ele possui cinquenta e quatro (54) portas digitais de entrada / saída (dos quais quinze (15) podem ser utilizadas como PWM e seis (6) como portas de interrupção), dezesseis (16) analógicas e quatro (4) UARTs. O Arduino possui tudo que é necessário para suportar o microcontrolador \cite{ARDUINOMEGA2015}.

\section{Padrão ZigBee}

ZigBee é um padrão que define um conjunto de protocolos de comunicação para redes sem fio de baixa taxa de transferência de dados. A taxa de transferência máxima é de 250Kbits/s. Suas principais características são: baixo custo, baixa taxa de transferência e consumo baixo de energia. Com o consumo baixo de energia aliado ao modo de economia de energia dos microcontroladores (conhecido com ``\textit{sleep mode}''), estes dispositivos podem operar por anos sem necessitar de troca de bateria \cite{farahani2011zigbee}.

O padrão ZigBee é desenvolvido pela ZigBee Aliance. A ZigBee Aliance foi fundada em 2002 como uma organização sem fins lucrativos aberta a quem queira se juntar a ela. O padrão ZigBee adotou a norma IEEE 802.15.5 e os protocolos \abrevpuc{MAC}{Medium Access Control}. O Padrão ZigBee foi especialmente desenvolvido para atender as necessidades de baixo custo de implementação de redes sem fio para baixa taxa de transferência e baixo consumo de energia \cite{farahani2011zigbee}.

\section{Comparação: ZigBee, Bluetooth e o Padrão IEEE 802.11}

Estes três padrões de redes sem fio comumente trabalham na frequência de 2.4GHz. O IEEE 802.11 trabalha com alta taxa de transferência (até 11Mbps), este é utilizado normalmente em redes sem fio de Internet. Ele consegue alcance de transferência entre 30 e 100m em ambientes fechados (``\textit{Indoor}''). O Bluetooth, trabalha com baixa taxa de transferência, menos de 3Mbps e seu alcance em ambiente fechado varia entre 2 e 10m. Normalmente utilizado em fones de ouvido sem fio. Em comparação com estes, o ZigBee é o que tem a taxa de transferência e a complexidade menor, além de consumir pouca energia. Devido a essas características, o ZigBee é ótimo para transmitir e receber comandos e/ou coletar dados de sensores, tais como sensores de temperatura e umidade. Nesse caso, o ZigBee oferece o melhor custo benefício coparado ao Bluetooth e ao IEEE 802.11 \cite{farahani2011zigbee}. Na Figura ~\ref{fig_comparacao_padroes_comunicacao} é possível visualizar as principais diferenças entre estes padrões.

\begin{figure}[h!]
  \centering
  \epsfig{file=ZigBee_Bluetooth_IEEE802.eps}
  \caption{Comparação entre o padrão ZigBee como o Bluetooth e o IEEE 802.11b. Fonte: FARAHANI, 2011, p. 3 }
  \label{fig_comparacao_padroes_comunicacao}
\end{figure}

\section{Sensores}

Para o desenvolvimento do trabalho, se faz necessário o uso de sensores que serão responsáveis pelas medições dos dados de trabalho do trator. 

O termo sensor é empregado para designar dispositivos sensíveis a alguma forma de energia do ambiente, que pode ser luminosa, térmica, cinética, relacionando informações sobre uma grandeza a ser medida como temperatura, pressão, velocidade, corrente, aceleração, posição, etc. \cite{bastos1997uso}.

\subsection{Encoder}

O deslocamento de um corpo é uma das poucas grandezas físicas que podem ser compreendidas como um valor digital sem o uso de um conversor analógico-digital. Encoders são dispositivos que covertem deslocamento angular e linear em pulsos \cite{thomazini2005sensores}.

O encoder permite a leitura de grandezas como: velocidade, direção e posição do movimento. Sendo esse movimento linear ou angular.

Podem ser encontrados dois tipos de encoder: o incremental e o absoluto. O encoder incremental indica o deslocamento em relação a um ponto inicial de referência gerando um pulso para cada unidade de deslocamento, enquanto o encoder absoluto mede o deslocamento em relação a um ponto de referência interno do dispositivo, este gera um código binário para cada unidade de deslocamento \cite{thomazini2005sensores}. Na Figura ~\ref{fig_encoders} podemos ver a diferença entre a arquitetura destes encoders.

\begin{figure}[h!]
  \centering
  \epsfig{file=encoders.eps}
  \caption{Diferença entre encoder incremental e absoluto.}
  \label{fig_encoders}
\end{figure}

\subsection{Termopar}

Em 1821, o físico Thomas Johann Seebeck descobriu que em um circuito fechado, feito com fios de dois metais heterogêneos, uma corrente elétrica fluirá se a temperatura de uma junção T1 estiver acima da temperatura da outra extremidade T2 \cite{thomazini2005sensores}. Na Figura ~\ref{fig_circuitoSeebeck} podemos ver a representação do circuito proposto.

\begin{figure}[h!]
  \centering
  \epsfig{file=Circuito_de_Seebeck.eps}
  \caption{Circuito de Seebeck}
  \label{fig_circuitoSeebeck}
\end{figure}

Este circuito gera uma \abrevpuc{FEM}{Força Eletro-Motriz} que é relacionada com o campo elétrico formado pelo aquecimento que é a função do gradiente de temperatura neste ponto. Baseado no efeito de Seebeck, a FEM gerada é o fenômeno em que ocorre uma circulação de corrente em um circuito formado por dois metais heterogêneos, quando há uma diferença de temperatura entre as duas junções \cite{thomazini2005sensores}.

Um termopar funciona medindo a diferença de potencial causada pelos fios diferentes. Dessa forma, pode-se medir diretamente a diferença entre temperaturas ou medir a temperatura absoluta, colocando em uma junção a temperatura conhecida \cite{thomazini2005sensores}.

Os termopares são os sensores de temperatura mais utilizados atualmente. Isso se deve a sua simplicidade e confiabilidade dos mesmos \cite{moreira2002mediccao}. Na Figura ~\ref{fig_exemploTermopar} temos um exemplo de sensor termopar.

\begin{figure}[h!]
  \centering
  \epsfig{file=exemplo_termopar.eps}
  \caption{Exemplo de Termopar}
  \label{fig_exemploTermopar}
\end{figure}

Segundo \cite{moreira2002mediccao}, os termopares são divididos em três categorias: termopares padronizados de metal nobre, termopares padronizados de metal base e termopares não definidos por letras. Termopares de metal nobre contém platina e os termopares de metal base contém níquel. 

Dentro dessas categorias, com base na utilização e conhecimento mais comuns nos dias atuais, existem oito tipos de termoelemento: S, R, B (metal nobre) e J, K, N, T e E (metal base) \cite{thomazini2005sensores}.

\subsection{Ultrassonico}

Os sensores ultrassônicos emitem ondas sonoras em frequências muito altas. Os transdutores ultrassônicos tem cristais de piezelétricos que ressonam a uma frequência desejada convertendo energia elétrica em energia acústica e vice-versa. As ondas são transmitidas e refletidas em forma de cone \cite{thomazini2005sensores}. 

Os ultrassônicos unem a variedade de utilização ao baixo custo. Isso faz com que sejam empregados em muitas aplicaçoes. Historicamente, a aplicação mais habitual dos ultrassônicos é na medição de distâncias por meio do método pulso-eco, por transdutores elétricos \cite{bastos1997uso}.

Na técnica pulso-eco a medida de distância é feita por meio da determinação de tempo de trânsito que gasta uma onda ultrassônica para percorrer o trajeto de ida e volta\cite{bastos1997uso}. Podemos visualizar isso na Figura ~\ref{fig_UltrassonicoPulsoEco}.

\begin{figure}[h!]
  \centering
  \epsfig{file=pulso-eco.eps}
  \caption{Método pulso-eco.}
  \label{fig_UltrassonicoPulsoEco}
\end{figure}

É necessária uma distância mínima entre o sensor e o objeto para que possam haver os ecos e os mesmos possam ser interpretados e calculados. O ângulo da superfície do objeto, rugosidade da superfície, mudanças na temperatura e umidade do ambiente. Os objetos podem ter qualquer forma refletiva, inclusive podem ser redondos \cite{bastos1997uso}.

Estes sensores são utilizados para diversos fins, tais como medição de diâmetro, presença de pessoas, medição de densidade, entre outros \cite{bastos1997uso}.

\section{Conclusão}

Durante este capítulo, foram descritos os conhecimentos básicos necessários para o desenvolvimento e entendimento do trabalho. No próximo capítulo serão esplanados os assuntos pertinentes ao desenvolvimento e aplicação do dispositivo.

\chapter{Desenvolvimento}\label{cap_desenvolvimento}

O dispositivo desenvolvido neste trabalho visa prover uma solução eficaz e confiável para telemetria de tratores agrícolas. Por meio deste dispositivo, diversas informações pertinentes ao funcionamento do trator serão medidas. Com isso se torna possível analisar de forma mais precisa fatores que podem prejudicar o funcionamento esperado do mesmo.

Os fatores referentes ao funcionamento do trator que serão sensoriados serão: fluxo e temperatura de entrada de combustível no motor, fluxo e temperatura do retorno de combustível do motor, fluxo e temperatura do ar da admissão, temperatura da água do radiador, peso que o trator está puxando, velocidade de cada roda de forma independente, velocidade efetiva do trator e velocidade na TDP. 

\section{Importância do Sistema}

Atualmente a Agricultura é tida como umas das vilãs do aquecimento global por meio do desmatamento que ocorre devido a cescente demanda de produtos alimentícios. Esse aumento na demanda ocorre devido ao constante crescimento da população mundial. 

Neste contexto, cada vez mais tem-se investido em formas de produzir mais sem que seja necessário aumentar a área plantada. Vários meios de se conseguir isso estão sendo pesquisados e implantados, podemos citar coisas como: irrigação automatizada com uso de sensores, automação de estufas, sensoriamento de microclima, etc. 

O dispositivo proposto neste trabalho visa fornecer uma ferramenta para telemetria dos dados de operação de tratores, item que ainda recebe pouca atenção no Brasil. Estes tratores são utilizados em larga escala para várias etapas do processo de plantio e colheita. Estes tratores, caso não estejam operando de forma correta, podem gerar excesso de gases poluentes, desgaste acelerado, baixa autonomia e atrazo nos processos de platio e colheita. Com esta telemetria, podemos avaliar os dados de operação do trator de forma concisa e assim avaliar sua situação de forma precisa e caso necessário, tomar as ações pertinentes para fazer com que este trator volte aos parâmetros aceitáveis de operação.

\section{Limitações}

As limitações deste dispositivo estão associadas ao rádio responsável por enviar os pacotes de dados. Isso se dá, pois dependendo do rádio que for utilizado, temos diferentes capacidades de alcance. No protótipo desenvolvido para este trabalho, foi utilizado um rádio Digi Xbee Serie 2, com alcance de até 150 metros. Devido a isso, o dispositivo que for utilizado como coletor poderá ficar a até no máximo 150 metros do dispositivo para poder manter a comunicação. Porém, o recomendado é não chegar a até essa distância para garantir que nenhum pacote seja perdido devido a distância. Devido a isso, não é recomendado exceder uma distância de cerca de 120 metros entre o dispositivo e o coletor.

\section{Visão Macro do Protótipo}

Os dados coletados no trator serão empacotados e enviados via rádio para um coletor (\textit{Gateway}). Este coletor poderá ser um computador com um módulo \textit{sniffer} RF para possibilitar a comunicação entre o computador e o dispositivo. Após isso, essa informação poderá ser tratada de várias formas, como: planilhas, relatórios ou até mesmo por meio de aplicação Web, onde estes dados podem ser exibidos em tempo real para qualquer lugar no mundo. A Figura ~\ref{fig_arquitetura} representa este cenário. 

\begin{figure}[H]
  \centering
  \epsfig{file=diagrama_de_rede.eps}
  \caption{Arquitetura proposta}
  \label{fig_arquitetura}
\end{figure}

\section{Como Será Desenvolvido o Sistema}

Devido a grande quantidade de sensores e de encoders, foi dividida a carga de processamento em dois Arduinos, para que assim o protótipo fique mais resistente a falhas que podem ocorrer devido ao processamento necessário. 

Deste modo, o primeiro Arduino ficou responsável por cinco encoders (com possibilidade para seis), assim mensurando:

\begin{itemize}

\item Locomoção do trator (quatro rodas);
\item Velocidade na TDP.

\end{itemize}
E o segundo Arduino recebeu os sensores pertinentes ao funcionamento do trator, sendo eles:

\begin{itemize}

\item Fluxo e temperatura de combustível da entrada e saída do motor;
\item Fluxo e temperatura do ar na admissão;
\item Temperatura dos gases do escapamento;
\item Temperatura da água do arrefecimento;
\item Peso na barra barra de tração;
\item Velocidade real do trator.

\end{itemize}

O primeiro Arduino ficou apenas com os encoders, pois estes trabalham por meio das portas de interrupção do Arduino. Dois dos encoders geram 360 pulsos a cada revolução. Se somadas todas as interrupções que podem ser geradas por estes encoders podemos ver que isso por sí pode exigir muito do Arduino. Os fluxometros (responsáveis pela medição de fluxo) também são encoders, porém, estes sofrem menos revoluções e com isso não afetam o segundo Arduino. Portanto, foi definida tal divisão.

Devido a isso, foram desenvolvidos dois softwares embarcados, sendo um para cada módulo. Ambos serão descritos nas seções ~\ref{sec_analise} e ~\ref{sec_desenvolvimento}.

\section{Análise do Software do Protótipo}\label{sec_analise}

Como os softwares embarcados deste protótipo são relativamente simples. A modelagem deles também se torna muito simples. Para auxiliar no entendimento, serão demonstrados dois diagramas \abrevpuc{UML}{Unified Modeling Language} do software, sendo eles: o diagrama de classe de cada módulo e o diagrama de máquina de estados (igual para ambos os softwares embarcados).

\subsection{Diagramas de Classe}

Uma vez que é de conhecimento a necessidade de dividir o trabalho em dois microcontroladores. Temos que passar a analisar o software de forma independente. 

No software embarcado no microcontrolador responsável pelos encoders, temos dois arquivos de código fonte, sendo um o arquivo principal (\textit{Main}), responsável por controlar todo o ciclo da execução e uma classe chamada \textit{Encoder}, responsável por encapsular os atributos e ações dos encoders. Essa classe \textit{Encoder} é utilizada como biblioteca na classe principal. Podemos ver o diagrama de classe deste módulo na Figura ~\ref{fig_diag_classe_one}.

\begin{figure}[H]
  \centering
  \epsfig{file=Diagrama_de_classe_encoders.eps}
  \caption{Diagrama de classe do módulo de encoders}
  \label{fig_diag_classe_one}
\end{figure}

No software embarcado no microcontrolador responsável pelos sensores, temos mais arquivos de código fonte. Como no módulo dos encoders, neste módulo também precisamos de um arquivo principal que é responsável pela execução. Este faz uso de diversas bibliotecas, dentre elas temos as implementadas para este dispositivo, sendo elas: \textit{Encoder} (igual a do módulo dos encoders); \textit{Fluxometer} (responsável por encapsular os atributos e ações dos sensores do tipo fluxometro); \textit{Thermocouple} (responsável por encapsular os atributos e ações dos sensores do tipo termopar) e \textit{Pitot} (responsável por encapsular os atributos e ações dos sensores do tipo válvula de pitot). Podemos ver o diagrama de classe deste módulo na Figura ~\ref{fig_diag_classe_two}.

\begin{figure}[H]
  \centering
  \epsfig{file=Diagrama_de_classe_sensores.eps}
  \caption{Diagrama de classe do módulo de sensores}
  \label{fig_diag_classe_two}
\end{figure}

\subsection{Diagrama de Máquina de Estados}

O diagrama de máquina de estados visa representar os estados dos programas durante sua execução. Como este diagrama fornece uma visão macro dos estados. Utilizamos o mesmo diagrama para os dois módulos, ou seja, os dois módulos (módulo encoders e módulo sensores) operam de forma muito semelhante, apenas diferenciam no número e no tipo de sensores que controlam. Na Figura ~\ref{fig_maq_estados} podemos ver o diagrama de máquina de estados deste trabalho.

\begin{figure}[H]
  \centering
  \epsfig{file=Maquina_de_estados.eps}
  \caption{Diagrama de máquina de estados}
  \label{fig_maq_estados}
\end{figure}

\section{Desenvolvimento do Protótipo}\label{sec_desenvolvimento} 

O desenvolvimento do protótipo foi dividido em dois, sendo: hardware e software. As tecnologias principais do hardware são: 2x Arduino Mega 2560 (processamento dos dados), 3x XBee (comunicação. Sendo dois no \textit{End Device} e um no Coordenador) e os sensores comerciais utilizados. Estes sensores são compostos por:

\begin{itemize}

\item 5x encoders: para medir a velocidade em cada roda e na TDP;
\item 2x fluxometro: para medir o fluxo de combustível na entrada e no retorno do motor;
\item 5x termopar: para medir temperatura do combustível na entrada e no retorno do motor, do ar da admissão, dos gases do escapamento e do liquido de arrefecimento;
\item 1x sensor de pressão: para medir o fluxo de entrada de ar na admissão;
\item 1x célula de carga: para medir o peso que o trator está puxando na barra de tração;
\item 1x ultrassonico: para medir a velocidade real do trator.

\end{itemize}

Para realizar a ligação de todos estes componentes, foi desenvolvida uma placa de circuito eletrônico onde estes sensores, Arduinos e rádios são ligados. Na figura ~\ref{fig_circuito_eletronico} podemos ver como ficou a placa de circuito eletrônico.

\begin{figure}[H]
  \centering
  \epsfig{file=circuito_eletronico.eps}
  \caption{Placa de circuito eletrônico.}
  \label{fig_circuito_eletronico}
\end{figure}

Um fator importante que deve ser levado em consideração é a integridade deste circuito. Uma vez que ele estará operando em um ambiente com bastante vibração, ruído e com possibilidade de respingos de água. Faz-se necessário prover uma forma de proteção. Devido a isso, foi desenvolvida uma caixa para alocação do circuito e ao mesmo tempo facilitar as conexões de cabos. A Figura ~\ref{fig_caixa_circuito_eletronico} mostra a caixa desenvolvida.

\begin{figure}[H]
  \centering
  \epsfig{file=caixa_circuito.eps}
  \caption{Caixa para proteção do circuito eletrônico.}
  \label{fig_caixa_circuito_eletronico}
\end{figure}

A alimentação do dispositivo é proveniente da bateria do próprio trator.

O desenvolvimento do software embarcado foi feito nas linguagens de programação C e C++ e compilado com a IDE do próprio Arduino. O versionamento de código foi feito por meio de repositório no GitHub.

\section{Teste do Protótipo durante Ensaio em Trator}

O protótipo foi desenvolvido para um projeto proveniente de uma parceria entre o Centro Universitário Católica de Santa Catarina (Brasil) e a Universidade Federal do Paraná (Brasil) para a automação da aquisição de dados de operação de tratores agrícolas para uso em ensaios. Desta forma, este dispositivo foi utilizado em conjunto com outros componentes de software  desenvolvidos por outros acadêmicos, estes componentes são: \textit{Middleware} (responsável por receber e persistir em um banco de dados os dados coletados) e Aplicação WEB (responsável por gerar e exibir gráficos a partir dos dados coletados).

O trator escolhido para o teste foi um T7 da marca New Holland. Como forma de simular peso na barra de tração, foi utilizado um cambão engatado em outro trator de porte maior responsável por frear e dessa forma simular o peso de arrasto. Na figura ~\ref{fig_trator_teste} podemos ver o trator em teste (esquerda) equipado com os sensores e ligado ao segundo trator (direita).

\begin{figure}[H]
  \centering
  \epsfig{file=trator_teste.eps}
  \caption{Preparação do trator a ser testado.}
  \label{fig_trator_teste}
\end{figure}

\chapter{Resultados}\label{cap_resultados}

Com os dados coletados durante o ensaio do trator, faz-se possível gerar informações para a análise do desempenho do mesmo. Esses dados, por serem coletados e transmitidos em tempo real, possibilitam a construção da informação também em tempo real. Abaixo serão descritas algumas das informações geradas com os dados coletados, sendo elas a avanço por roda e o consumo horário de combustível. Para facilitar a leitura foi utilizado uma parcela de 150 segundos do ensaio para a plotagem dos gráficos.

\section{Avanço por Roda}

A medição dos dados de avanço do trator são feitas por meio de um encoder ligado a cada roda. Dessa forma, podemos obter informações como: distância percorrida, períodos no qual ela patinou e velocidade.

\section{Avanço Real}

\section{Consumo Horário de Combustível}

A medição de consumo do trator é feita com os valores das leituras do fluxometro de entrada de combustível no motor e o de retorno de combustível. A fórmula para o cálculo dessa informação é: ${(FluxIn - FluxOut) * 3,6}$ onde ${FluxIn}$ é o valor do fluxometro de entrada, ${FluxOut}$ é o valor do fluxometro de retorno e ${3,6}$ é referente a conversão de ml/s para l/h. A partir dessa fórmula é possível obter o consumo em Litros/Hora.

Como a coleta dessa informação é feita no Controlador dos Sensores e este foi configurado para fazer as leituras em intervalos de cinco segundos, a função que utilizamos foi ${[(FluxIn - FluxOut)/5] * 3,6}$, onde a adição do ${/5}$ é para obter o consumo médio por segundo a cada leitura efetuada nos fluxometros.

Com a aplicação dessa fórmula sobre os dados coletados foi gerado o gráfico que demonstra o consumo do trator durante a parcela de tempo selecionada do ensaio. A figura ~\ref{fig_grafico_consumo} representa este gráfico.

\begin{figure}[H]
  \centering
  \epsfig{file=grafico_consumo.eps}
  \caption{Consumo do trator durante o ensaio.}
  \label{fig_grafico_consumo}
\end{figure}

\chapter{Conclusão}\label{cap_conclusao}

%Referencias:
\bibliographystyle{abntex2-alf}
\bibliography{Monografia}

%\appendix

%\chapter{Título do Apêndice}

%\section{Seção}

%\subsection{Sub-Seção}



%EXEMPLOS

%Subfiguras:

%\begin{figure}
%  \centering
%  \begin{tabular}{@{}c@{}}
%    \includegraphics[width=.9\linewidth,height=270pt]{fluxograma_sensores.PNG} \\[\abovecaptionskip]
%    \small (a) Fluxograma do controlador dos encoders
%  \end{tabular}

%  \vspace{\floatsep}

%  \begin{tabular}{@{}c@{}}
%    \includegraphics[width=.9\linewidth,height=270pt]{fluxograma_sensores.PNG} \\[\abovecaptionskip]
%    \small (b) Fluxograma do controlador dos sensores
%  \end{tabular}

%  \caption{Fluxogramas dos módulos do protótipo.}\label{fig_fluxogramas}
%\end{figure}

\end{document}
